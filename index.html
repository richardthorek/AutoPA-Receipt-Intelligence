<!DOCTYPE html>
<html class="uk-background-muted" lang="en-au" dir="ltr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AutoPA Receipt Intelligence</title>

  <!-- UIkit CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.21.11/dist/css/uikit.min.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/monokai-sublime.min.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/solid.css"
    integrity="sha384-r/k8YTFqmlOaqRkZuSiE9trsrDXkh07mRaoGBMoDcmA58OHILZPsk29i2BsFng1B" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/fontawesome.css"
    integrity="sha384-4aon80D8rXCGx9ayDt85LbyUHeMWd3UiBaWliBlJ53yzm9hqN21A+o1pqoyK04h+" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdn.auth0.com/js/auth0-samples-theme/1.0/css/auth0-theme.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    (function () {
      const isLocalhost = window.location.hostname === 'localhost' && window.location.port === '3000';
      const stylesheets = [
        { href: isLocalhost ? '/css/main.css' : '/public/css/main.css' }
      ];

      stylesheets.forEach(stylesheetInfo => {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = stylesheetInfo.href;
        document.head.appendChild(link);
      });
    })();
  </script>

</head>

<body>
  <!-- Whole Page Container -->
  <div id="app" class="uk-container uk-container-center uk-margin-auto">
    <!-- Navigation Bar -->
    <nav class="uk-navbar uk-margin-auto">
      <div class="uk-navbar-container uk-navbar-transparent">
        <ul class="uk-navbar-nav uk-hidden-small">
          <li>
            <a href="/">Home</a>
          </li>
          <li>
            <a href="#documentationCanvas" uk-toggle>Documentation</a>
          </li>
          <!-- Login button: show if NOT authenticated -->
          <li class="auth-invisible uk-flex uk-flex-middle">
            <button id="qsLoginBtn" onclick="login()"
              class="uk-button uk-button-small uk-button-primary auth-invisible hidden">
              Log in
            </button>
          </li>
          <li class="auth-visible hidden">
            <a href="#offcanvas-usage" uk-toggle>Menu</a> <!-- Profile Dropdown -->
            <div uk-dropdown>
              <ul class="uk-nav uk-dropdown-nav">
                <li>
                  <a href="/profile" class="dropdown-item dropdown-profile route-link">
                    <i class="fas fa-user mr-3"></i> Profile
                  </a>
                </li>
                <li>
                  <a href="#" class="dropdown-item" id="qsLogoutBtn" onclick="logout()">
                    <i class="fas fa-power-off mr-3"></i> Log out
                  </a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <div id="main-content" class="">
      <div id="content-home" class="page">
        <h1 class="uk-heading-divider">AutoPA Receipt Intelligence</h1>

        <div id="authenticatedContent" class="uk-container uk-container-expand" style="display: none;">

          <!-- User Profile Data Hidden Input -->
          <input type="hidden" id="userToken" value="" />


          <!-- Upload Section -->
          <div id="uploadSection" class="uk-flex uk-flex-center uk-flex-middle uk-child-width-expand">
            <div class="uk-grid uk-card uk-card-default uk-child-width-expand drop-zone uk-margin-auto" id="dropZone">
              <div class="js-upload uk-placeholder uk-text-center">
                <span uk-icon="icon: cloud-upload"></span>
                <span class="uk-text-middle">Attach receipts by dropping them here or click to select one</span>
                <div uk-form-custom>
                  <input id="fileInput" type="file" multiple accept=".jpg,.jpeg,.png,.pdf">
                </div>
              </div>
            </div>
          </div>


          <div id="receiptPreview" class="">

          </div>

          <!-- Receipt Images Off Canvas -->

          <div id="imgCanvas" uk-offcanvas>
            <div class="uk-offcanvas-bar">

              <button class="uk-offcanvas-close" type="button" uk-close></button>
              <h4>Receipt Image</h4>
              <div class="uk-card uk-card-default uk-card-body uk-padding-small">
                <img id="canvasImg" class="uk-width-1-1" style="padding: 10px;" alt="Receipt Image">
              </div>
            </div>
          </div>



          <!-- User Guide -->

          <div id="documentationCanvas" uk-offcanvas="flip: true">
            <div class="uk-offcanvas-bar">

              <button class="uk-offcanvas-close" type="button" uk-close></button>
              <div id="documentationContent"></div>
            </div>
          </div>

          <h3 class="uk-card-title">Filter</h3>

          <!-- Filter Section -->

          <div id="filterSection" class="uk-card uk-card-default uk-card-body uk-margin-auto">
            <div class="uk-grid-small uk-child-width-expand@s uk-grid-match" data-uk-grid>
              <div>
                <div class="uk-card uk-card-small ">
                  <label class="uk-text-muted uk-text-small" for="filterFromDate">From:</label>
                  <input type="date" data-uk-datepicker="{format:'YYYY-MM-DD'}" id="filterFromDate" class="uk-input"
                    placeholder="Date From" />
                </div>
              </div>
              <div>
                <div class="uk-card uk-card-small">
                  <label class="uk-text-muted uk-text-small" for="filterToDate">To:</label>
                  <input type="date" data-uk-datepicker="{format:'YYYY-MM-DD'}" id="filterToDate" class="uk-input"
                    placeholder="Date To" />
                </div>
              </div>
              <div>
                <div class="uk-card uk-card-small uk-flex uk-flex-middle uk-flex-bottom">
                  <button id="getBtn" class="uk-button uk-button-default uk-width-1-1">Get</button>
                </div>
              </div>
              <div>
                <div class="uk-card uk-card-small uk-flex uk-flex-middle uk-flex-bottom">
                  <button id="downloadBtn" class="uk-button uk-button-default uk-width-1-1">Download</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Results Table -->
          <h3 class="uk-card-title">Results</h3>
          <div id="resultsSection"
            class="uk-grid uk-flex uk-flex-center uk-flex-middle uk-child-width-expand uk-margin-auto">
            <div class="uk-card uk-card-default uk-card-body uk-width-1-1">
              <table id="resultsTable" class="uk-table uk-table-divider uk-table-responsive">
                <thead>
                  <tr>
                    <th>Merchant Name</th>
                    <th>Address</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Item Name</th>
                    <th>Item Total Price</th>
                    <th>Receipt</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- User Profile Data and Page -->
  <div class="page" id="content-profile">
    <div class="uk-container">
      <div class="uk-grid">
        <div class="uk-width-1-1">
          <!-- <pre class="uk-card uk-card-default uk-card-body">
            <code id="profile-data" class="json"></code>
          </pre> -->

          <div class="auth-visible hidden uk-card uk-card-default uk-width-1-2@m">
            <div class="uk-card-header">
              <div class="uk-grid-small uk-flex-middle" uk-grid>
                <div class="uk-width-auto">
                  <img id="profileImg" class="uk-border-circle" width="40" height="40" src="images/avatar.jpg"
                    alt="Avatar">
                </div>
                <div class="uk-width-expand">
                  <h3 id="profileNickname" class="uk-card-title uk-margin-remove-bottom uk-text-capitalize">Title</h3>
                  <p id="profileLastUpdated" class="uk-text-meta uk-margin-remove-top"><time
                      datetime="2016-04-01T19:00">April 01, 2016</time></p>
                </div>
              </div>
            </div>
            <div class="uk-card-body">
              <ul class="uk-list uk-list-disc uk-list-muted">
                <li id="profileSub">List item 1</li>
                <li id="profileEmail">List item 2</li>
              </ul>
            </div>
            <div class="uk-card-footer">
              <a id="profile-link" href="#" class="uk-button uk-button-text">Read more</a>
            </div>
          </div>


        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const isLocalhost = window.location.hostname === 'localhost' && window.location.port === '3000';
      const scripts = [
        { src: isLocalhost ? '/js/ui.js' : '/public/js/ui.js' },
        { src: isLocalhost ? '/js/app.js' : '/public/js/app.js' },
        { src: isLocalhost ? '/js/fileProcessing.js' : '/public/js/fileProcessing.js' }
      ];

      scripts.forEach(scriptInfo => {
        const script = document.createElement('script');
        script.src = scriptInfo.src;
        document.body.appendChild(script);
      });
    })();
  </script>

  <!-- UIkit JS -->

  <script src="https://cdn.jsdelivr.net/npm/uikit@3.21.11/dist/js/uikit.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.21.11/dist/js/uikit-icons.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script type="text/javascript" src="https://unpkg.com/markdown-it/dist/markdown-it.min.js"></script>
  <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
        const githubRepo = 'richardthorek/AutoPA-Receipt-Intelligence'; // Replace with your GitHub username/repo
        const readmeUrl = `https://api.github.com/repos/${githubRepo}/contents/README.md`;

        fetch(readmeUrl, {
            headers: {
                'Accept': 'application/vnd.github.v3.raw'
            }
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.text();
        })
        .then(markdown => {
            // const htmlContent = marked(markdown);
            document.getElementById('documentationContent').innerHTML = marked.parse(markdown);
        })
        .catch(error => console.error('Error fetching README.md:', error));
    });
</script>

</body>

</html>